---
layout: post
title: Sizing thread pools
---

### Sizing thread pools

Whenever we are writing multi-threaded applications, we need to decide how many threads are required for which task. 
This number is a factor of hardaware the application will run on and it can not be a fixed number. Whenever we deploy such an application 
to any hardware, we need to benchmark and fine tune this number. To get a good starting point, we can think of it in this way :

1. Machine has 4 cores. 
2. We need to run 8 tasks, each takes 10 second.
3. If we run 4 tasks in parallel, all the tasks will finish in 20 second. This is the best performance we can expect. 
   In such a scenario, it is  a good idea to size the thread pool for such a task to the number of cores.
4. Imagine each of these tasks spend 5 seconds out of 10 seconds doing IO (disk or network). 
5. This means the cores are idle for 5 seconds while IO is happening. i.e 40 seconds in total.
6. During these idle 40 seconds, the cores can be alloted to work on different threads.
7. This means we can increase the the thread pool size to 8. 
8. Now this entire operation will complete in 15 seconds.

----
****
